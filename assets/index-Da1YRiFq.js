import{r as e,a as s,u as a,b as t,L as r,N as l,c as n,B as i,R as d,d as c,e as o}from"./vendor-BD-DLcbP.js";import{a as m,z as x,F as h}from"./utils-BkDkzqdI.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)}).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();var p={exports:{}},u={},g=e,y=Symbol.for("react.element"),f=Symbol.for("react.fragment"),j=Object.prototype.hasOwnProperty,v=g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,b={key:!0,ref:!0,__self:!0,__source:!0};function N(e,s,a){var t,r={},l=null,n=null;for(t in void 0!==a&&(l=""+a),void 0!==s.key&&(l=""+s.key),void 0!==s.ref&&(n=s.ref),s)j.call(s,t)&&!b.hasOwnProperty(t)&&(r[t]=s[t]);if(e&&e.defaultProps)for(t in s=e.defaultProps)void 0===r[t]&&(r[t]=s[t]);return{$$typeof:y,type:e,key:l,ref:n,props:r,_owner:v.current}}u.Fragment=f,u.jsx=N,u.jsxs=N,p.exports=u;var w=p.exports,k={},C=s;k.createRoot=C.createRoot,k.hydrateRoot=C.hydrateRoot;const E=m.create({baseURL:"https://whatsisb--amondocorre.replit.app/api",headers:{"Content-Type":"application/json"}});E.interceptors.request.use(e=>{const s=localStorage.getItem("token");return s&&(e.headers.Authorization=`Bearer ${s}`),e},e=>Promise.reject(e)),E.interceptors.response.use(e=>e,e=>{var s;return 401===(null==(s=e.response)?void 0:s.status)&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});const S=e.createContext(),M=()=>{const s=e.useContext(S);if(!s)throw new Error("useAuth debe ser usado dentro de un AuthProvider");return s},A=({children:s})=>{const[t,r]=e.useState(null),[l,n]=e.useState(!0),i=a();e.useEffect(()=>{const e=localStorage.getItem("token"),s=localStorage.getItem("user");e&&s&&(r(JSON.parse(s)),E.defaults.headers.common.Authorization=`Bearer ${e}`),n(!1)},[]);const d={user:t,loading:l,login:async(e,s)=>{var a,t;try{const a=await E.post("/auth/login",{username:e,password:s});if(a.data.success){const{user:e,token:s}=a.data.data;localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(e)),E.defaults.headers.common.Authorization=`Bearer ${s}`,r(e),x.success("Inicio de sesión exitoso");const t="/whatsis/";return window.location.href=t,{success:!0}}}catch(l){const e=(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Error al iniciar sesión";return x.error(e),{success:!1,message:e}}},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),delete E.defaults.headers.common.Authorization,r(null),x.success("Sesión cerrada"),i("/login")},isAdmin:()=>["super_admin","admin_empresa","admin"].includes(null==t?void 0:t.role),isSuperAdmin:()=>"super_admin"===(null==t?void 0:t.role),isAuthenticated:!!t};return w.jsx(S.Provider,{value:d,children:s})};
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var z={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=(s,a)=>{const t=e.forwardRef(({color:t="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:n,className:i="",children:d,...c},o)=>{return e.createElement("svg",{ref:o,...z,width:r,height:r,stroke:t,strokeWidth:n?24*Number(l)/Number(r):l,className:["lucide",`lucide-${m=s,m.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,i].join(" "),...c},[...a.map(([s,a])=>e.createElement(s,a)),...Array.isArray(d)?d:[d]]);var m});return t.displayName=`${s}`,t},$=I("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),P=I("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),q=I("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),L=I("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),R=I("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),T=I("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),D=I("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),_=I("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]),U=I("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),O=I("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),V=I("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),F=I("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),W=I("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),H=I("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),B=I("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),G=I("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Q=I("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Z=I("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),J=I("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]),X=I("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),K=I("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Y=I("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),ee=I("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),se=I("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),ae=I("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),te=I("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),re=I("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),le=I("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),ne=I("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ie=({children:e})=>{const{user:s,logout:a}=M(),l=t(),n=[{name:"Dashboard",href:"/",icon:U},{name:"Números Emisores",href:"/senders",icon:G},{name:"Enviar Mensajes",href:"/send",icon:Y},{name:"Campañas",href:"/campaigns",icon:O}],i=[{name:"Empresas",href:"/admin/companies",icon:q},{name:"Planes",href:"/admin/plans",icon:H}];return w.jsxs("div",{className:"min-h-screen bg-gray-50",children:[w.jsx("nav",{className:"bg-white shadow-sm border-b",children:w.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:w.jsxs("div",{className:"flex justify-between h-16",children:[w.jsxs("div",{className:"flex",children:[w.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[w.jsx(G,{className:"h-8 w-8 text-primary-600"}),w.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"WhatsApp Multi-Sender"})]}),w.jsxs("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[n.map(e=>{const s=e.icon;return w.jsxs(r,{to:e.href,className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium "+(a=e.href,l.pathname===a?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:[w.jsx(s,{className:"h-4 w-4 mr-2"}),e.name]},e.name);var a}),"super_admin"===(null==s?void 0:s.role)&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"border-l border-gray-300 mx-2"}),i.map(e=>{const s=e.icon;return w.jsxs(r,{to:e.href,className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium "+(l.pathname.startsWith(e.href)?"border-purple-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:[w.jsx(s,{className:"h-4 w-4 mr-2"}),e.name]},e.name)})]})]})]}),w.jsx("div",{className:"flex items-center",children:w.jsxs("div",{className:"flex items-center space-x-4",children:[w.jsxs("div",{className:"flex items-center text-sm text-gray-700",children:[w.jsx(te,{className:"h-5 w-5 mr-2 text-gray-400"}),w.jsx("span",{className:"font-medium",children:null==s?void 0:s.username}),"super_admin"===(null==s?void 0:s.role)&&w.jsx("span",{className:"ml-2 px-2 py-1 text-xs font-semibold text-purple-800 bg-purple-100 rounded-full",children:"Super Admin"}),"admin_empresa"===(null==s?void 0:s.role)&&w.jsx("span",{className:"ml-2 px-2 py-1 text-xs font-semibold text-blue-800 bg-blue-100 rounded-full",children:"Admin Empresa"}),"admin"===(null==s?void 0:s.role)&&w.jsx("span",{className:"ml-2 px-2 py-1 text-xs font-semibold text-primary-800 bg-primary-100 rounded-full",children:"Admin"})]}),w.jsxs("button",{onClick:a,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[w.jsx(F,{className:"h-4 w-4 mr-2"}),"Salir"]})]})})]})})}),w.jsx("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:e})]})},de=({children:e})=>{const{isAuthenticated:s,loading:a}=M();return a?w.jsx("div",{className:"min-h-screen flex items-center justify-center",children:w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):s?w.jsx(ie,{children:e}):w.jsx(l,{to:"/login",replace:!0})},ce=()=>{const[s,a]=e.useState(""),[t,r]=e.useState(""),[l,n]=e.useState(!1),{login:i}=M();return w.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-primary-100 py-12 px-4 sm:px-6 lg:px-8",children:w.jsxs("div",{className:"max-w-md w-full space-y-8",children:[w.jsxs("div",{children:[w.jsx("div",{className:"flex justify-center",children:w.jsx(G,{className:"h-16 w-16 text-primary-600"})}),w.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sistema de Envío WhatsApp"}),w.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Multi-Número · Gestión Profesional v1.0.0."})]}),w.jsxs("form",{className:"mt-8 space-y-6 bg-white p-8 rounded-lg shadow-lg",onSubmit:async e=>{e.preventDefault(),n(!0),await i(s,t),n(!1)},children:[w.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[w.jsxs("div",{className:"mb-4",children:[w.jsx("label",{htmlFor:"username",className:"sr-only",children:"Usuario"}),w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:w.jsx(te,{className:"h-5 w-5 text-gray-400"})}),w.jsx("input",{id:"username",name:"username",type:"text",autoComplete:"username",required:!0,className:"appearance-none rounded-lg relative block w-full pl-10 px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Usuario",value:s,onChange:e=>a(e.target.value)})]})]}),w.jsxs("div",{children:[w.jsx("label",{htmlFor:"password",className:"sr-only",children:"Contraseña"}),w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:w.jsx(V,{className:"h-5 w-5 text-gray-400"})}),w.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-lg relative block w-full pl-10 px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Contraseña",value:t,onChange:e=>r(e.target.value)})]})]})]}),w.jsx("div",{children:w.jsx("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:l?w.jsxs("span",{className:"flex items-center",children:[w.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Iniciando sesión..."]}):"Iniciar Sesión"})})]})]})})},oe={getAll:async()=>(await E.get("/senders")).data,getById:async e=>(await E.get(`/senders/${e}`)).data,create:async e=>(await E.post("/senders",e)).data,update:async(e,s)=>(await E.put(`/senders/${e}`,s)).data,delete:async e=>(await E.delete(`/senders/${e}`)).data,initialize:async e=>(await E.post(`/senders/${e}/initialize`)).data,disconnect:async e=>(await E.post(`/senders/${e}/disconnect`)).data,getQRCode:async e=>(await E.get(`/senders/${e}/qr`)).data,getStatus:async e=>(await E.get(`/senders/${e}/status`)).data},me={async uploadExcel(e){const s=new FormData;s.append("file",e);return(await E.post("/messages/upload",s,{headers:{"Content-Type":"multipart/form-data"}})).data},createCampaign:async e=>(await E.post("/messages/campaign",e)).data,sendMessages:async e=>(await E.post("/messages/send",{campaignId:e})).data,getCampaigns:async()=>(await E.get("/messages/campaigns")).data,getCampaignById:async e=>(await E.get(`/messages/campaigns/${e}`)).data,getCampaignLogs:async e=>(await E.get(`/messages/campaigns/${e}/logs`)).data,testSendMessage:async e=>(await E.post("/messages/test",e)).data},xe=()=>{const[s,a]=e.useState({totalSenders:0,activeSenders:0,totalCampaigns:0,sentMessages:0}),[t,l]=e.useState(!0);e.useEffect(()=>{n()},[]);const n=async()=>{try{const[e,s]=await Promise.all([oe.getAll(),me.getCampaigns()]),t=e.data||[],r=s.data||[],l=t.filter(e=>e.isConnected).length,n=r.reduce((e,s)=>e+(s.sentMessages||0),0);a({totalSenders:t.length,activeSenders:l,totalCampaigns:r.length,sentMessages:n})}catch(e){x.error("Error al cargar estadísticas")}finally{l(!1)}},i=[{title:"Números Emisores",value:s.totalSenders,icon:G,color:"bg-blue-500",link:"/senders"},{title:"Números Activos",value:s.activeSenders,icon:L,color:"bg-green-500",link:"/senders"},{title:"Campañas Totales",value:s.totalCampaigns,icon:O,color:"bg-purple-500",link:"/campaigns"},{title:"Mensajes Enviados",value:s.sentMessages,icon:Y,color:"bg-orange-500",link:"/campaigns"}];return t?w.jsx("div",{className:"flex items-center justify-center h-64",children:w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):w.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[w.jsx("div",{className:"sm:flex sm:items-center",children:w.jsxs("div",{className:"sm:flex-auto",children:[w.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Dashboard"}),w.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"Resumen general del sistema de envío de WhatsApp"})]})}),w.jsx("div",{className:"mt-8 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:i.map(e=>{const s=e.icon;return w.jsx(r,{to:e.link,className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-lg transition-shadow",children:w.jsx("div",{className:"p-5",children:w.jsxs("div",{className:"flex items-center",children:[w.jsx("div",{className:`flex-shrink-0 ${e.color} rounded-md p-3`,children:w.jsx(s,{className:"h-6 w-6 text-white"})}),w.jsx("div",{className:"ml-5 w-0 flex-1",children:w.jsxs("dl",{children:[w.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:e.title}),w.jsx("dd",{className:"text-3xl font-semibold text-gray-900",children:e.value})]})})]})})},e.title)})}),w.jsxs("div",{className:"mt-8 grid grid-cols-1 gap-5 lg:grid-cols-2",children:[w.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[w.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Acciones Rápidas"}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs(r,{to:"/senders",className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[w.jsx(G,{className:"h-5 w-5 text-primary-600 mr-3"}),w.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Gestionar Números Emisores"})]}),w.jsxs(r,{to:"/send",className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[w.jsx(Y,{className:"h-5 w-5 text-primary-600 mr-3"}),w.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Enviar Mensajes"})]}),w.jsxs(r,{to:"/campaigns",className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[w.jsx(O,{className:"h-5 w-5 text-primary-600 mr-3"}),w.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Ver Campañas"})]})]})]}),w.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[w.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Información del Sistema"}),w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"flex items-start",children:[w.jsx(L,{className:"h-5 w-5 text-green-500 mr-3 mt-0.5"}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Sistema Operativo"}),w.jsx("p",{className:"text-sm text-gray-500",children:"Gestión multi-número activa"})]})]}),w.jsxs("div",{className:"flex items-start",children:[w.jsx(T,{className:"h-5 w-5 text-blue-500 mr-3 mt-0.5"}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Envío Secuencial"}),w.jsx("p",{className:"text-sm text-gray-500",children:"Delay de 2 segundos entre mensajes"})]})]}),w.jsxs("div",{className:"flex items-start",children:[w.jsx(le,{className:"h-5 w-5 text-orange-500 mr-3 mt-0.5"}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Manejo de Errores"}),w.jsx("p",{className:"text-sm text-gray-500",children:"Registro automático de fallos"})]})]})]})]})]})]})},he=({isOpen:e,onClose:s,onConfirm:a,title:t,message:r,confirmText:l="Confirmar",cancelText:n="Cancelar",type:i="warning"})=>{if(!e)return null;return w.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:w.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[w.jsxs("div",{className:`flex items-center justify-between p-4 border-b ${{warning:"bg-yellow-50 border-yellow-200",danger:"bg-red-50 border-red-200",info:"bg-blue-50 border-blue-200",success:"bg-green-50 border-green-200"}[i]}`,children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t}),w.jsx("button",{onClick:s,className:"text-gray-500 hover:text-gray-700 transition-colors",children:w.jsx(ne,{size:20})})]}),w.jsx("div",{className:"p-6",children:w.jsx("p",{className:"text-gray-700",children:r})}),w.jsxs("div",{className:"flex justify-end gap-3 p-4 bg-gray-50 rounded-b-lg",children:[w.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:n}),w.jsx("button",{onClick:()=>{a(),s()},className:`px-4 py-2 text-white rounded-lg transition-colors ${{warning:"bg-yellow-600 hover:bg-yellow-700",danger:"bg-red-600 hover:bg-red-700",info:"bg-blue-600 hover:bg-blue-700",success:"bg-green-600 hover:bg-green-700"}[i]}`,children:l})]})]})})},pe=()=>{const[s,a]=e.useState([]),[t,r]=e.useState(!0),[l,n]=e.useState(!1),[i,d]=e.useState(!1),[c,o]=e.useState(!1),[m,h]=e.useState(null),[p,u]=e.useState(null),[g,y]=e.useState({alias:"",phoneNumber:""}),{isAdmin:f}=M();e.useEffect(()=>{j()},[]);const j=async()=>{try{const e=await oe.getAll();a(e.data||[])}catch(e){x.error("Error al cargar números emisores")}finally{r(!1)}},v=e=>{const s={activo:"bg-green-100 text-green-800",inactivo:"bg-gray-100 text-gray-800",conectando:"bg-yellow-100 text-yellow-800",desconectado:"bg-red-100 text-red-800"};return s[e]||s.inactivo};return t?w.jsx("div",{className:"flex items-center justify-center h-64",children:w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):w.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[w.jsxs("div",{className:"sm:flex sm:items-center",children:[w.jsxs("div",{className:"sm:flex-auto",children:[w.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Números Emisores"}),w.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"Gestiona los números de WhatsApp desde los cuales se enviarán mensajes"})]}),f()&&w.jsx("div",{className:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none",children:w.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:[w.jsx(Q,{className:"h-4 w-4 mr-2"}),"Agregar Número"]})})]}),w.jsx("div",{className:"mt-8 flex flex-col",children:w.jsx("div",{className:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8",children:w.jsx("div",{className:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8",children:w.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:w.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[w.jsx("thead",{className:"bg-gray-50",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Alias"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Número"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Estado"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Conexión"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Acciones"})]})}),w.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:s.map(e=>w.jsxs("tr",{children:[w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm font-medium text-gray-900",children:e.alias}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.phoneNumber}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm",children:w.jsx("span",{className:`inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${v(e.status)}`,children:e.status})}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm",children:e.isConnected?w.jsx("span",{className:"text-green-600 font-medium",children:"Conectado"}):w.jsx("span",{className:"text-gray-500",children:"Desconectado"})}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:w.jsxs("div",{className:"flex space-x-2",children:[e.isConnected?w.jsx("button",{onClick:()=>(async e=>{try{await oe.disconnect(e),x.success("WhatsApp desconectado"),j()}catch(s){x.error("Error al desconectar WhatsApp")}})(e.id),className:"text-red-600 hover:text-red-900",title:"Desconectar",children:w.jsx(Z,{className:"h-5 w-5"})}):w.jsxs(w.Fragment,{children:[w.jsx("button",{onClick:()=>(async e=>{try{await oe.initialize(e),x.success("Inicializando WhatsApp. Escanea el código QR."),setTimeout(()=>j(),2e3)}catch(s){x.error("Error al inicializar WhatsApp")}})(e.id),className:"text-green-600 hover:text-green-900",title:"Conectar",children:w.jsx(J,{className:"h-5 w-5"})}),"conectando"===e.status&&w.jsx("button",{onClick:()=>(async e=>{h(e),d(!0);const s=setInterval(async()=>{try{const a=await oe.getQRCode(e.id);h(e=>({...e,qrCode:a.data.qrCode,status:a.data.status})),a.data.isConnected&&(clearInterval(s),x.success("WhatsApp conectado exitosamente"),d(!1),j())}catch(a){clearInterval(s)}},3e3);setTimeout(()=>clearInterval(s),12e4)})(e),className:"text-blue-600 hover:text-blue-900",title:"Ver QR",children:w.jsx(X,{className:"h-5 w-5"})})]}),f()&&w.jsx("button",{onClick:()=>(e=>{u(e),o(!0)})(e),className:"text-red-600 hover:text-red-900",title:"Eliminar",children:w.jsx(ee,{className:"h-5 w-5"})})]})})]},e.id))})]})})})})}),l&&w.jsx("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:w.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[w.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>n(!1)}),w.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:[w.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Agregar Número Emisor"}),w.jsxs("form",{onSubmit:async e=>{var s,a;e.preventDefault();try{await oe.create(g),x.success("Número emisor registrado exitosamente"),n(!1),y({alias:"",phoneNumber:""}),j()}catch(t){x.error((null==(a=null==(s=t.response)?void 0:s.data)?void 0:a.message)||"Error al registrar número")}},children:[w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Alias"}),w.jsx("input",{type:"text",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",value:g.alias,onChange:e=>y({...g,alias:e.target.value})})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Número de Teléfono"}),w.jsx("input",{type:"text",required:!0,placeholder:"Ej: 573001234567",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",value:g.phoneNumber,onChange:e=>y({...g,phoneNumber:e.target.value})})]})]}),w.jsxs("div",{className:"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3 sm:grid-flow-row-dense",children:[w.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:col-start-2 sm:text-sm",children:"Guardar"}),w.jsx("button",{type:"button",onClick:()=>n(!1),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:col-start-1 sm:text-sm",children:"Cancelar"})]})]})]})]})}),i&&m&&w.jsx("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:w.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[w.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>d(!1)}),w.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-md sm:w-full sm:p-6",children:[w.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4 text-center",children:"Escanea el código QR con WhatsApp"}),w.jsx("div",{className:"flex justify-center",children:m.qrCode?w.jsx("img",{src:m.qrCode,alt:"QR Code",className:"w-64 h-64"}):w.jsx("div",{className:"w-64 h-64 flex items-center justify-center bg-gray-100 rounded",children:w.jsx(K,{className:"h-12 w-12 text-gray-400 animate-spin"})})}),w.jsxs("p",{className:"mt-4 text-sm text-gray-500 text-center",children:["Estado: ",w.jsx("span",{className:"font-medium",children:m.status})]}),w.jsx("button",{onClick:()=>d(!1),className:"mt-4 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:text-sm",children:"Cerrar"})]})]})}),w.jsx(he,{isOpen:c,onClose:()=>{o(!1),u(null)},onConfirm:async()=>{var e,s;if(p)try{await oe.delete(p.id),x.success("Número emisor desactivado exitosamente"),j()}catch(a){const t=(null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.message)||"Error al desactivar número emisor";x.error(t)}finally{u(null)}},title:"Desactivar Número Emisor",message:`¿Estás seguro de desactivar el número emisor "${null==p?void 0:p.alias}" (${null==p?void 0:p.phoneNumber})? El número quedará inactivo pero podrás reactivarlo más tarde. Las campañas y mensajes asociados se conservarán.`,confirmText:"Desactivar",cancelText:"Cancelar",type:"warning"})]})},ue=()=>{const[s,a]=e.useState([]),[t,r]=e.useState(""),[l,n]=e.useState(null),[i,d]=e.useState([]),[c,o]=e.useState(""),[m,h]=e.useState(!1),[p,u]=e.useState(1);e.useEffect(()=>{g()},[]);const g=async()=>{try{const e=((await oe.getAll()).data||[]).filter(e=>e.isConnected);a(e)}catch(e){x.error("Error al cargar números emisores")}};return w.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[w.jsx("div",{className:"sm:flex sm:items-center",children:w.jsxs("div",{className:"sm:flex-auto",children:[w.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Enviar Mensajes"}),w.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"Carga un archivo Excel y selecciona el número emisor para enviar mensajes masivos"})]})}),w.jsx("div",{className:"mt-8 max-w-3xl",children:w.jsx("div",{className:"bg-white shadow sm:rounded-lg",children:w.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[1===p&&w.jsx("div",{className:"space-y-6",children:w.jsxs("div",{children:[w.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Paso 1: Cargar Archivo Excel"}),w.jsxs("div",{className:"mt-4",children:[w.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4 mb-4",children:w.jsxs("div",{className:"flex",children:[w.jsx($,{className:"h-5 w-5 text-blue-400"}),w.jsxs("div",{className:"ml-3",children:[w.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Formato del archivo Excel"}),w.jsxs("div",{className:"mt-2 text-sm text-blue-700",children:[w.jsx("p",{children:"El archivo debe contener las siguientes columnas:"}),w.jsxs("ul",{className:"list-disc list-inside mt-1",children:[w.jsxs("li",{children:[w.jsx("strong",{children:"telefono"}),": Número de teléfono (solo dígitos)"]}),w.jsxs("li",{children:[w.jsx("strong",{children:"mensaje"}),": Texto del mensaje a enviar"]})]})]})]})]})}),w.jsx("div",{className:"mt-4 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:w.jsxs("div",{className:"space-y-1 text-center",children:[w.jsx(_,{className:"mx-auto h-12 w-12 text-gray-400"}),w.jsxs("div",{className:"flex text-sm text-gray-600",children:[w.jsxs("label",{className:"relative cursor-pointer bg-white rounded-md font-medium text-primary-600 hover:text-primary-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-primary-500",children:[w.jsx("span",{children:"Seleccionar archivo"}),w.jsx("input",{type:"file",className:"sr-only",accept:".xlsx,.xls",onChange:e=>{const s=e.target.files[0];s&&n(s)}})]}),w.jsx("p",{className:"pl-1",children:"o arrastra y suelta"})]}),w.jsx("p",{className:"text-xs text-gray-500",children:"Solo archivos Excel (.xlsx, .xls)"}),l&&w.jsxs("p",{className:"text-sm text-green-600 font-medium mt-2",children:["Archivo seleccionado: ",l.name]})]})}),w.jsxs("button",{onClick:async()=>{var e,s;if(l){h(!0);try{const e=await me.uploadExcel(l);e.success?(d(e.data.messages),x.success(`${e.data.validRows} mensajes cargados correctamente`),u(2)):x.error("Errores en el archivo Excel")}catch(a){x.error((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.message)||"Error al procesar archivo")}finally{h(!1)}}else x.error("Selecciona un archivo Excel")},disabled:!l||m,className:"mt-4 w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[w.jsx(ae,{className:"h-4 w-4 mr-2"}),m?"Procesando...":"Cargar y Validar"]})]})]})}),2===p&&w.jsx("div",{className:"space-y-6",children:w.jsxs("div",{children:[w.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Paso 2: Configurar Envío"}),w.jsxs("div",{className:"mt-4 space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre de la Campaña"}),w.jsx("input",{type:"text",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Ej: Campaña Promocional Enero 2024",value:c,onChange:e=>o(e.target.value)})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Seleccionar Número Emisor"}),w.jsxs("select",{className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",value:t,onChange:e=>r(e.target.value),children:[w.jsx("option",{value:"",children:"-- Selecciona un número --"}),s.map(e=>w.jsxs("option",{value:e.id,children:[e.alias," (",e.phoneNumber,")"]},e.id))]}),0===s.length&&w.jsx("p",{className:"mt-2 text-sm text-red-600",children:'No hay números emisores conectados. Ve a "Números Emisores" para conectar uno.'})]}),w.jsxs("div",{className:"bg-gray-50 rounded-md p-4",children:[w.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Vista Previa de Mensajes"}),w.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["Total de mensajes: ",w.jsx("strong",{children:i.length})]}),w.jsxs("div",{className:"max-h-60 overflow-y-auto space-y-2",children:[i.slice(0,5).map((e,s)=>w.jsxs("div",{className:"bg-white p-3 rounded border border-gray-200",children:[w.jsxs("p",{className:"text-xs text-gray-500",children:["Para: ",e.telefono]}),w.jsx("p",{className:"text-sm text-gray-900 mt-1",children:e.mensaje})]},s)),i.length>5&&w.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["... y ",i.length-5," mensajes más"]})]})]}),w.jsxs("div",{className:"flex space-x-3",children:[w.jsx("button",{onClick:()=>{u(1),d([]),n(null)},className:"flex-1 inline-flex justify-center items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Volver"}),w.jsxs("button",{onClick:async()=>{var e,s;if(t)if(c.trim())if(0!==i.length){h(!0);try{const e=await me.createCampaign({name:c,senderId:parseInt(t),messages:i});if(e.success){(await me.sendMessages(e.data.id)).success&&(x.success("Envío de mensajes iniciado. Revisa el progreso en Campañas."),u(1),n(null),d([]),o(""),r(""))}}catch(a){x.error((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.message)||"Error al enviar mensajes")}finally{h(!1)}}else x.error("No hay mensajes para enviar");else x.error("Ingresa un nombre para la campaña");else x.error("Selecciona un número emisor")},disabled:!t||!c||m,className:"flex-1 inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[w.jsx(Y,{className:"h-4 w-4 mr-2"}),m?"Enviando...":"Enviar Mensajes"]})]})]})]})})]})})})]})},ge=()=>{const[s,a]=e.useState([]),[t,l]=e.useState(!0);e.useEffect(()=>{n()},[]);const n=async()=>{try{const e=await me.getCampaigns();a(e.data||[])}catch(e){x.error("Error al cargar campañas")}finally{l(!1)}},i=e=>{const s={pendiente:"bg-gray-100 text-gray-800",en_proceso:"bg-blue-100 text-blue-800",completada:"bg-green-100 text-green-800",cancelada:"bg-red-100 text-red-800",error:"bg-red-100 text-red-800"};return s[e]||s.pendiente};return t?w.jsx("div",{className:"flex items-center justify-center h-64",children:w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):w.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[w.jsxs("div",{className:"sm:flex sm:items-center",children:[w.jsxs("div",{className:"sm:flex-auto",children:[w.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Campañas de Mensajes"}),w.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"Historial de todas las campañas de envío de mensajes"})]}),w.jsx("div",{className:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none",children:w.jsxs("button",{onClick:n,className:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:[w.jsx(K,{className:"h-4 w-4 mr-2"}),"Actualizar"]})})]}),w.jsx("div",{className:"mt-8 flex flex-col",children:w.jsx("div",{className:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8",children:w.jsx("div",{className:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8",children:w.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:w.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[w.jsx("thead",{className:"bg-gray-50",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Nombre"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Número Emisor"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Total"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Enviados"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Fallidos"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Estado"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Fecha"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Acciones"})]})}),w.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:0===s.length?w.jsx("tr",{children:w.jsx("td",{colSpan:"8",className:"px-3 py-8 text-center text-sm text-gray-500",children:"No hay campañas registradas"})}):s.map(e=>{var s,a;return w.jsxs("tr",{children:[w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm font-medium text-gray-900",children:e.name}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:(null==(s=e.sender)?void 0:s.alias)||"-"}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.totalMessages}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-green-600 font-medium",children:e.sentMessages}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-red-600 font-medium",children:e.failedMessages}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm",children:w.jsx("span",{className:`inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${i(e.status)}`,children:e.status})}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:(a=e.createdAt,a?new Date(a).toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-")}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:w.jsx(r,{to:`/campaigns/${e.id}`,className:"text-primary-600 hover:text-primary-900",title:"Ver detalles",children:w.jsx(D,{className:"h-5 w-5"})})})]},e.id)})})]})})})})})]})},ye=()=>{var s,a;const{id:t}=n(),[l,i]=e.useState(null),[d,c]=e.useState([]),[o,m]=e.useState(!0);e.useEffect(()=>{h()},[t]);const h=async()=>{try{const[e,s]=await Promise.all([me.getCampaignById(t),me.getCampaignLogs(t)]);i(e.data),c(s.data||[])}catch(e){x.error("Error al cargar detalles de la campaña")}finally{m(!1)}},p=e=>{switch(e){case"enviado":return w.jsx(L,{className:"h-5 w-5 text-green-500"});case"fallido":return w.jsx(le,{className:"h-5 w-5 text-red-500"});default:return w.jsx(T,{className:"h-5 w-5 text-gray-400"})}},u=e=>e?new Date(e).toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-";if(o)return w.jsx("div",{className:"flex items-center justify-center h-64",children:w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});if(!l)return w.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:w.jsxs("div",{className:"text-center py-12",children:[w.jsx("p",{className:"text-gray-500",children:"Campaña no encontrada"}),w.jsx(r,{to:"/campaigns",className:"mt-4 text-primary-600 hover:text-primary-700",children:"Volver a campañas"})]})});const g=l.totalMessages>0?(l.sentMessages/l.totalMessages*100).toFixed(1):0;return w.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[w.jsx("div",{className:"mb-6",children:w.jsxs(r,{to:"/campaigns",className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700",children:[w.jsx(P,{className:"h-4 w-4 mr-2"}),"Volver a campañas"]})}),w.jsx("div",{className:"bg-white shadow sm:rounded-lg mb-6",children:w.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[w.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:l.name}),w.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[w.jsxs("div",{className:"bg-gray-50 px-4 py-5 rounded-lg",children:[w.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total de Mensajes"}),w.jsx("dd",{className:"mt-1 text-3xl font-semibold text-gray-900",children:l.totalMessages})]}),w.jsxs("div",{className:"bg-green-50 px-4 py-5 rounded-lg",children:[w.jsx("dt",{className:"text-sm font-medium text-green-600 truncate",children:"Enviados"}),w.jsx("dd",{className:"mt-1 text-3xl font-semibold text-green-900",children:l.sentMessages})]}),w.jsxs("div",{className:"bg-red-50 px-4 py-5 rounded-lg",children:[w.jsx("dt",{className:"text-sm font-medium text-red-600 truncate",children:"Fallidos"}),w.jsx("dd",{className:"mt-1 text-3xl font-semibold text-red-900",children:l.failedMessages})]}),w.jsxs("div",{className:"bg-blue-50 px-4 py-5 rounded-lg",children:[w.jsx("dt",{className:"text-sm font-medium text-blue-600 truncate",children:"Tasa de Éxito"}),w.jsxs("dd",{className:"mt-1 text-3xl font-semibold text-blue-900",children:[g,"%"]})]})]}),w.jsx("div",{className:"mt-6 border-t border-gray-200 pt-6",children:w.jsxs("dl",{className:"grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2",children:[w.jsxs("div",{children:[w.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Número Emisor"}),w.jsxs("dd",{className:"mt-1 text-sm text-gray-900",children:[null==(s=l.sender)?void 0:s.alias," (",null==(a=l.sender)?void 0:a.phoneNumber,")"]})]}),w.jsxs("div",{children:[w.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Estado"}),w.jsx("dd",{className:"mt-1 text-sm text-gray-900 capitalize",children:l.status})]}),w.jsxs("div",{children:[w.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Fecha de Creación"}),w.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:u(l.createdAt)})]}),w.jsxs("div",{children:[w.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Fecha de Finalización"}),w.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:u(l.completedAt)})]})]})})]})}),w.jsx("div",{className:"bg-white shadow sm:rounded-lg",children:w.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[w.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Registro de Mensajes"}),w.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:w.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[w.jsx("thead",{className:"bg-gray-50",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Teléfono"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Mensaje"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Estado"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Fecha de Envío"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Error"})]})}),w.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:d.map(e=>w.jsxs("tr",{children:[w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-900",children:e.phoneNumber}),w.jsx("td",{className:"px-3 py-4 text-sm text-gray-500 max-w-xs truncate",children:e.message}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm",children:w.jsxs("div",{className:"flex items-center",children:[p(e.status),w.jsx("span",{className:"ml-2 capitalize",children:e.status})]})}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:u(e.sentAt)}),w.jsx("td",{className:"px-3 py-4 text-sm text-red-600 max-w-xs truncate",children:e.errorMessage||"-"})]},e.id))})]})})]})})]})},fe=()=>E.get("/plans"),je=e=>E.post("/plans",e),ve=(e,s)=>E.put(`/plans/${e}`,s),be=e=>E.delete(`/plans/${e}`),Ne=()=>{const[s,a]=e.useState([]),[t,r]=e.useState(!0),[l,n]=e.useState(!1),[i,d]=e.useState(!1),[c,o]=e.useState(null),[m,h]=e.useState(null),[p,u]=e.useState({name:"",maxMessagesMonth:1e3,maxSenders:1,features:{}});e.useEffect(()=>{g()},[]);const g=async()=>{try{const e=await fe();a(e.data.data||[])}catch(e){x.error("Error al cargar planes")}finally{r(!1)}},y=()=>{u({name:"",maxMessagesMonth:1e3,maxSenders:1,features:{}}),o(null)};return t?w.jsx("div",{className:"flex justify-center items-center h-64",children:"Cargando..."}):w.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[w.jsxs("div",{className:"sm:flex sm:items-center",children:[w.jsxs("div",{className:"sm:flex-auto",children:[w.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Gestión de Planes"}),w.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"Administra los planes disponibles para las empresas"})]}),w.jsx("div",{className:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none",children:w.jsxs("button",{onClick:()=>{y(),n(!0)},className:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:w-auto",children:[w.jsx(Q,{className:"h-4 w-4 mr-2"}),"Nuevo Plan"]})})]}),w.jsx("div",{className:"mt-8 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:s.map(e=>{var s,a;return w.jsxs("div",{className:"relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm hover:border-gray-400 transition-colors",children:[w.jsxs("div",{className:"flex items-center justify-between mb-4",children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),w.jsxs("div",{className:"flex space-x-2",children:[w.jsx("button",{onClick:()=>(e=>{o(e),u({name:e.name,maxMessagesMonth:e.maxMessagesMonth,maxSenders:e.maxSenders,features:e.features||{}}),n(!0)})(e),className:"text-blue-600 hover:text-blue-900",title:"Editar",children:w.jsx(B,{className:"h-5 w-5"})}),w.jsx("button",{onClick:()=>(e=>{h(e),d(!0)})(e),className:"text-red-600 hover:text-red-900",title:"Desactivar",children:w.jsx(ee,{className:"h-5 w-5"})})]})]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("span",{className:"text-sm text-gray-500",children:"Mensajes/Mes:"}),w.jsx("span",{className:"text-sm font-medium text-gray-900",children:(a=e.maxMessagesMonth,a>=999999999?"Ilimitado":a.toLocaleString())})]}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("span",{className:"text-sm text-gray-500",children:"Números Emisores:"}),w.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.maxSenders})]}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("span",{className:"text-sm text-gray-500",children:"Empresas:"}),w.jsx("span",{className:"text-sm font-medium text-gray-900",children:(null==(s=e.companies)?void 0:s.length)||0})]}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("span",{className:"text-sm text-gray-500",children:"Estado:"}),e.isActive?w.jsxs("span",{className:"inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800",children:[w.jsx(R,{className:"h-3 w-3 mr-1"}),"Activo"]}):w.jsxs("span",{className:"inline-flex items-center rounded-full bg-red-100 px-2.5 py-0.5 text-xs font-medium text-red-800",children:[w.jsx(ne,{className:"h-3 w-3 mr-1"}),"Inactivo"]})]})]})]},e.id)})}),l&&w.jsx("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:w.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[w.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>n(!1)}),w.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:[w.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:c?"Editar Plan":"Crear Nuevo Plan"}),w.jsxs("form",{onSubmit:async e=>{var s,a;e.preventDefault();try{c?(await ve(c.id,p),x.success("Plan actualizado exitosamente")):(await je(p),x.success("Plan creado exitosamente")),n(!1),y(),g()}catch(t){x.error((null==(a=null==(s=t.response)?void 0:s.data)?void 0:a.message)||"Error al guardar plan")}},children:[w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre del Plan"}),w.jsx("input",{type:"text",required:!0,value:p.name,onChange:e=>u({...p,name:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",placeholder:"Ej: Starter, Growth, Pro"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Mensajes por Mes"}),w.jsx("input",{type:"number",required:!0,min:"0",value:p.maxMessagesMonth,onChange:e=>u({...p,maxMessagesMonth:parseInt(e.target.value)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",placeholder:"1000"}),w.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Usa 999999999 para ilimitado"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Números Emisores"}),w.jsx("input",{type:"number",required:!0,min:"1",value:p.maxSenders,onChange:e=>u({...p,maxSenders:parseInt(e.target.value)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",placeholder:"1"})]})]}),w.jsxs("div",{className:"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3 sm:grid-flow-row-dense",children:[w.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:col-start-2 sm:text-sm",children:c?"Actualizar":"Crear"}),w.jsx("button",{type:"button",onClick:()=>{n(!1),y()},className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:col-start-1 sm:text-sm",children:"Cancelar"})]})]})]})]})}),w.jsx(he,{isOpen:i,onClose:()=>{d(!1),h(null)},onConfirm:async()=>{var e,s;if(m)try{await be(m.id),x.success("Plan desactivado exitosamente"),g()}catch(a){x.error((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.message)||"Error al desactivar plan")}finally{h(null)}},title:"Desactivar Plan",message:`¿Estás seguro de desactivar el plan "${null==m?void 0:m.name}"? Las empresas que lo usan no podrán seguir operando hasta que se les asigne otro plan.`,confirmText:"Desactivar",cancelText:"Cancelar",type:"danger"})]})},we=(e=!1)=>E.get(`/companies?includeInactive=${e}`),ke=e=>E.get(`/companies/${e}`),Ce=e=>E.get(`/companies/${e}/stats`),Ee=e=>E.post("/companies",e),Se=(e,s)=>E.put(`/companies/${e}`,s),Me=e=>E.put(`/companies/${e}/reset-quota`),Ae=e=>E.delete(`/companies/${e}`),ze=()=>{const s=a(),[t,r]=e.useState([]),[l,n]=e.useState([]),[i,d]=e.useState(!0),[c,o]=e.useState(!1),[m,h]=e.useState(!1),[p,u]=e.useState(null),[g,y]=e.useState(null),[f,j]=e.useState({name:"",planId:""});e.useEffect(()=>{v()},[]);const v=async()=>{try{const[e,s]=await Promise.all([we(),fe()]);r(e.data.data||[]),n(s.data.data||[])}catch(e){x.error("Error al cargar datos")}finally{d(!1)}},b=()=>{j({name:"",planId:""}),u(null)},N=e=>e>=999999999?"Ilimitado":e.toLocaleString();return i?w.jsx("div",{className:"flex justify-center items-center h-64",children:"Cargando..."}):w.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[w.jsxs("div",{className:"sm:flex sm:items-center",children:[w.jsxs("div",{className:"sm:flex-auto",children:[w.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Gestión de Empresas"}),w.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"Administra las empresas y sus planes de servicio"})]}),w.jsx("div",{className:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none",children:w.jsxs("button",{onClick:()=>{b(),o(!0)},className:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:w-auto",children:[w.jsx(Q,{className:"h-4 w-4 mr-2"}),"Nueva Empresa"]})})]}),w.jsx("div",{className:"mt-8 flex flex-col",children:w.jsx("div",{className:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8",children:w.jsx("div",{className:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8",children:w.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:w.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[w.jsx("thead",{className:"bg-gray-50",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Empresa"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Plan"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Mensajes Usados"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Estado"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Usuarios"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Acciones"})]})}),w.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:t.map(e=>{var a,t,r,l;return w.jsxs("tr",{children:[w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm font-medium text-gray-900",children:e.name}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:(null==(a=e.plan)?void 0:a.name)||"Sin plan"}),w.jsxs("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:[e.messagesUsedMonth.toLocaleString()," / ",N((null==(t=e.plan)?void 0:t.maxMessagesMonth)||0)]}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm",children:w.jsx("span",{className:`inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${l=e.status,{active:"bg-green-100 text-green-800",suspended:"bg-yellow-100 text-yellow-800",cancelled:"bg-red-100 text-red-800"}[l]||"bg-gray-100 text-gray-800"}`,children:e.status})}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:(null==(r=e.users)?void 0:r.length)||0}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:w.jsxs("div",{className:"flex space-x-2",children:[w.jsx("button",{onClick:()=>s(`/admin/companies/${e.id}/stats`),className:"text-blue-600 hover:text-blue-900",title:"Ver estadísticas",children:w.jsx(se,{className:"h-5 w-5"})}),w.jsx("button",{onClick:()=>s(`/admin/companies/${e.id}/users`),className:"text-green-600 hover:text-green-900",title:"Gestionar usuarios",children:w.jsx(re,{className:"h-5 w-5"})}),w.jsx("button",{onClick:()=>(async(e,s)=>{if(window.confirm(`¿Reiniciar cuota mensual de "${s}"?`))try{await Me(e),x.success("Cuota mensual reiniciada"),v()}catch(a){x.error("Error al reiniciar cuota")}})(e.id,e.name),className:"text-purple-600 hover:text-purple-900",title:"Reiniciar cuota mensual",children:w.jsx(K,{className:"h-5 w-5"})}),w.jsx("button",{onClick:()=>(e=>{u(e),j({name:e.name,planId:e.planId}),o(!0)})(e),className:"text-yellow-600 hover:text-yellow-900",title:"Editar",children:w.jsx(B,{className:"h-5 w-5"})}),w.jsx("button",{onClick:()=>(e=>{y(e),h(!0)})(e),className:"text-red-600 hover:text-red-900",title:"Desactivar",children:w.jsx(ee,{className:"h-5 w-5"})})]})})]},e.id)})})]})})})})}),c&&w.jsx("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:w.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[w.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>o(!1)}),w.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:[w.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:p?"Editar Empresa":"Crear Nueva Empresa"}),w.jsxs("form",{onSubmit:async e=>{var s,a;e.preventDefault();try{p?(await Se(p.id,f),x.success("Empresa actualizada exitosamente")):(await Ee(f),x.success("Empresa creada exitosamente")),o(!1),b(),v()}catch(t){x.error((null==(a=null==(s=t.response)?void 0:s.data)?void 0:a.message)||"Error al guardar empresa")}},children:[w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre de la Empresa"}),w.jsx("input",{type:"text",required:!0,value:f.name,onChange:e=>j({...f,name:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",placeholder:"Ej: Empresa Demo S.A."})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Plan"}),w.jsxs("select",{required:!0,value:f.planId,onChange:e=>j({...f,planId:parseInt(e.target.value)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",children:[w.jsx("option",{value:"",children:"Seleccionar plan..."}),l.filter(e=>e.isActive).map(e=>w.jsxs("option",{value:e.id,children:[e.name," - ",N(e.maxMessagesMonth)," msgs/mes - ",e.maxSenders," emisores"]},e.id))]})]})]}),w.jsxs("div",{className:"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3 sm:grid-flow-row-dense",children:[w.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:col-start-2 sm:text-sm",children:p?"Actualizar":"Crear"}),w.jsx("button",{type:"button",onClick:()=>{o(!1),b()},className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:col-start-1 sm:text-sm",children:"Cancelar"})]})]})]})]})}),w.jsx(he,{isOpen:m,onClose:()=>{h(!1),y(null)},onConfirm:async()=>{var e,s;if(g)try{await Ae(g.id),x.success("Empresa desactivada exitosamente"),v()}catch(a){x.error((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.message)||"Error al desactivar empresa")}finally{y(null)}},title:"Desactivar Empresa",message:`¿Estás seguro de desactivar la empresa "${null==g?void 0:g.name}"? Los usuarios de esta empresa no podrán acceder al sistema.`,confirmText:"Desactivar",cancelText:"Cancelar",type:"danger"})]})},Ie=()=>{const{id:s}=n(),t=a(),[r,l]=e.useState(null),[i,d]=e.useState(!0);e.useEffect(()=>{c()},[s]);const c=async()=>{try{const e=await Ce(s);l(e.data.data)}catch(e){x.error("Error al cargar estadísticas")}finally{d(!1)}},o=e=>e>=999999999?"Ilimitado":e.toLocaleString();if(i)return w.jsx("div",{className:"flex justify-center items-center h-64",children:"Cargando..."});if(!r)return w.jsx("div",{className:"text-center py-12",children:"No se encontraron estadísticas"});const m=r.usage.quotaPercentage;return w.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[w.jsx("div",{className:"mb-6",children:w.jsxs("button",{onClick:()=>t("/admin/companies"),className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700",children:[w.jsx(P,{className:"h-4 w-4 mr-1"}),"Volver a empresas"]})}),w.jsxs("div",{className:"mb-8",children:[w.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:r.company.name}),w.jsxs("p",{className:"mt-2 text-sm text-gray-700",children:["Plan: ",w.jsx("span",{className:"font-medium",children:r.plan.name})]})]}),w.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4 mb-8",children:[w.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:w.jsx("div",{className:"p-5",children:w.jsxs("div",{className:"flex items-center",children:[w.jsx("div",{className:"flex-shrink-0",children:w.jsx(re,{className:"h-6 w-6 text-gray-400"})}),w.jsx("div",{className:"ml-5 w-0 flex-1",children:w.jsxs("dl",{children:[w.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Usuarios Activos"}),w.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:r.usage.activeUsers})]})})]})})}),w.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:w.jsx("div",{className:"p-5",children:w.jsxs("div",{className:"flex items-center",children:[w.jsx("div",{className:"flex-shrink-0",children:w.jsx(W,{className:"h-6 w-6 text-gray-400"})}),w.jsx("div",{className:"ml-5 w-0 flex-1",children:w.jsxs("dl",{children:[w.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Mensajes"}),w.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:r.usage.totalMessages.toLocaleString()})]})})]})})}),w.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:w.jsx("div",{className:"p-5",children:w.jsxs("div",{className:"flex items-center",children:[w.jsx("div",{className:"flex-shrink-0",children:w.jsx(Y,{className:"h-6 w-6 text-gray-400"})}),w.jsx("div",{className:"ml-5 w-0 flex-1",children:w.jsxs("dl",{children:[w.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Mensajes Este Mes"}),w.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:r.usage.messagesThisMonth.toLocaleString()})]})})]})})}),w.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:w.jsx("div",{className:"p-5",children:w.jsxs("div",{className:"flex items-center",children:[w.jsx("div",{className:"flex-shrink-0",children:w.jsx(se,{className:"h-6 w-6 text-gray-400"})}),w.jsx("div",{className:"ml-5 w-0 flex-1",children:w.jsxs("dl",{children:[w.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Mensajes Restantes"}),w.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:o(r.usage.messagesRemaining)})]})})]})})})]}),w.jsxs("div",{className:"bg-white shadow rounded-lg p-6 mb-8",children:[w.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Uso de Cuota Mensual"}),w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsxs("div",{className:"flex justify-between text-sm text-gray-700 mb-2",children:[w.jsxs("span",{children:["Mensajes usados: ",r.usage.messagesThisMonth.toLocaleString()]}),w.jsxs("span",{children:["Límite: ",o(r.plan.maxMessagesMonth)]})]}),w.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:w.jsx("div",{className:"h-4 rounded-full transition-all "+(m>=90?"bg-red-600":m>=70?"bg-yellow-600":"bg-green-600"),style:{width:`${Math.min(m,100)}%`}})}),w.jsxs("div",{className:"text-right text-sm text-gray-500 mt-1",children:[m.toFixed(1),"% utilizado"]})]}),m>=80&&w.jsx("div",{className:"rounded-md p-4 "+(m>=90?"bg-red-50":"bg-yellow-50"),children:w.jsx("div",{className:"flex",children:w.jsxs("div",{className:"ml-3",children:[w.jsx("h3",{className:"text-sm font-medium "+(m>=90?"text-red-800":"text-yellow-800"),children:m>=90?"Cuota casi agotada":"Advertencia de cuota"}),w.jsx("div",{className:"mt-2 text-sm "+(m>=90?"text-red-700":"text-yellow-700"),children:w.jsxs("p",{children:["La empresa ha utilizado el ",m.toFixed(1),"% de su cuota mensual.",m>=90&&" Considera actualizar el plan o reiniciar la cuota."]})})]})})})]})]}),w.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[w.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Detalles del Plan"}),w.jsxs("dl",{className:"grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2",children:[w.jsxs("div",{children:[w.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Plan Actual"}),w.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:r.plan.name})]}),w.jsxs("div",{children:[w.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Mensajes Mensuales"}),w.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:o(r.plan.maxMessagesMonth)})]}),w.jsxs("div",{children:[w.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Números Emisores Permitidos"}),w.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:r.plan.maxSenders})]}),w.jsxs("div",{children:[w.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Estado de la Empresa"}),w.jsx("dd",{className:"mt-1",children:w.jsx("span",{className:"inline-flex rounded-full px-2 text-xs font-semibold leading-5 "+("active"===r.company.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:r.company.status})})]})]})]})]})},$e=()=>{const{id:s}=n(),t=a(),[r,l]=e.useState(null),[i,d]=e.useState([]),[c,o]=e.useState(!0),[m,h]=e.useState(!1),[p,u]=e.useState(!1),[g,y]=e.useState(null),[f,j]=e.useState(null),[v,b]=e.useState({username:"",email:"",password:"",role:"operador"});e.useEffect(()=>{N()},[s]);const N=async()=>{try{const e=await ke(s);l(e.data.data),d(e.data.data.users||[])}catch(e){x.error("Error al cargar datos")}finally{o(!1)}},k=()=>{b({username:"",email:"",password:"",role:"operador"}),y(null)},C=e=>({super_admin:"Super Admin",admin_empresa:"Admin Empresa",admin:"Admin",operador:"Operador"}[e]||e);return c?w.jsx("div",{className:"flex justify-center items-center h-64",children:"Cargando..."}):r?w.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[w.jsx("div",{className:"mb-6",children:w.jsxs("button",{onClick:()=>t("/admin/companies"),className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700",children:[w.jsx(P,{className:"h-4 w-4 mr-1"}),"Volver a empresas"]})}),w.jsxs("div",{className:"sm:flex sm:items-center",children:[w.jsxs("div",{className:"sm:flex-auto",children:[w.jsxs("h1",{className:"text-2xl font-semibold text-gray-900",children:["Usuarios de ",r.name]}),w.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"Gestiona los usuarios que tienen acceso a esta empresa"})]}),w.jsx("div",{className:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none",children:w.jsxs("button",{onClick:()=>{k(),h(!0)},className:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:w-auto",children:[w.jsx(Q,{className:"h-4 w-4 mr-2"}),"Nuevo Usuario"]})})]}),w.jsx("div",{className:"mt-8 flex flex-col",children:w.jsx("div",{className:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8",children:w.jsx("div",{className:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8",children:w.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:w.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[w.jsx("thead",{className:"bg-gray-50",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Usuario"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Email"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Rol"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Estado"}),w.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Acciones"})]})}),w.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:0===i.length?w.jsx("tr",{children:w.jsx("td",{colSpan:"5",className:"px-3 py-8 text-center text-sm text-gray-500",children:"No hay usuarios registrados para esta empresa"})}):i.map(e=>{return w.jsxs("tr",{children:[w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm font-medium text-gray-900",children:e.username}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.email}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm",children:w.jsx("span",{className:`inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${s=e.role,{super_admin:"bg-purple-100 text-purple-800",admin_empresa:"bg-blue-100 text-blue-800",admin:"bg-green-100 text-green-800",operador:"bg-gray-100 text-gray-800"}[s]||"bg-gray-100 text-gray-800"}`,children:C(e.role)})}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm",children:e.isActive?w.jsxs("span",{className:"inline-flex items-center text-green-700",children:[w.jsx(R,{className:"h-4 w-4 mr-1"}),"Activo"]}):w.jsxs("span",{className:"inline-flex items-center text-red-700",children:[w.jsx(ne,{className:"h-4 w-4 mr-1"}),"Inactivo"]})}),w.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:w.jsxs("div",{className:"flex space-x-2",children:[w.jsx("button",{onClick:()=>(e=>{y(e),b({username:e.username,email:e.email,password:"",role:e.role}),h(!0)})(e),className:"text-blue-600 hover:text-blue-900",title:"Editar",children:w.jsx(B,{className:"h-5 w-5"})}),w.jsx("button",{onClick:()=>(e=>{j(e),u(!0)})(e),className:"text-red-600 hover:text-red-900",title:"Desactivar",children:w.jsx(ee,{className:"h-5 w-5"})})]})})]},e.id);var s})})]})})})})}),m&&w.jsx("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:w.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[w.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>h(!1)}),w.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:[w.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:g?"Editar Usuario":"Crear Nuevo Usuario"}),w.jsxs("form",{onSubmit:async e=>{var a,t;e.preventDefault();try{const e={...v,companyId:parseInt(s)};g?(await E.put(`/auth/users/${g.id}`,e),x.success("Usuario actualizado exitosamente")):(await E.post("/auth/register",e),x.success("Usuario creado exitosamente")),h(!1),k(),N()}catch(r){x.error((null==(t=null==(a=r.response)?void 0:a.data)?void 0:t.message)||"Error al guardar usuario")}},children:[w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre de Usuario"}),w.jsx("input",{type:"text",required:!0,value:v.username,onChange:e=>b({...v,username:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",placeholder:"usuario123"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),w.jsx("input",{type:"email",required:!0,value:v.email,onChange:e=>b({...v,email:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",placeholder:"usuario@empresa.com"})]}),w.jsxs("div",{children:[w.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Contraseña ",g&&"(dejar vacío para no cambiar)"]}),w.jsx("input",{type:"password",required:!g,value:v.password,onChange:e=>b({...v,password:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",placeholder:"********"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Rol"}),w.jsxs("select",{required:!0,value:v.role,onChange:e=>b({...v,role:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",children:[w.jsx("option",{value:"operador",children:"Operador"}),w.jsx("option",{value:"admin",children:"Admin"}),w.jsx("option",{value:"admin_empresa",children:"Admin Empresa"})]}),w.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Operador: solo envía mensajes | Admin: gestiona emisores | Admin Empresa: gestión completa"})]})]}),w.jsxs("div",{className:"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3 sm:grid-flow-row-dense",children:[w.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:col-start-2 sm:text-sm",children:g?"Actualizar":"Crear"}),w.jsx("button",{type:"button",onClick:()=>{h(!1),k()},className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:col-start-1 sm:text-sm",children:"Cancelar"})]})]})]})]})}),w.jsx(he,{isOpen:p,onClose:()=>{u(!1),j(null)},onConfirm:async()=>{var e,s;if(f)try{await E.delete(`/auth/users/${f.id}`),x.success("Usuario desactivado exitosamente"),N()}catch(a){x.error((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.message)||"Error al desactivar usuario")}finally{j(null)}},title:"Desactivar Usuario",message:`¿Estás seguro de desactivar al usuario "${null==f?void 0:f.username}"? No podrá acceder al sistema.`,confirmText:"Desactivar",cancelText:"Cancelar",type:"danger"})]}):w.jsx("div",{className:"text-center py-12",children:"Empresa no encontrada"})};function Pe(){return w.jsx(i,{basename:"/whatsis/",children:w.jsxs(A,{children:[w.jsx(h,{position:"top-right"}),w.jsxs(d,{children:[w.jsx(c,{path:"/login",element:w.jsx(ce,{})}),w.jsx(c,{path:"/",element:w.jsx(de,{children:w.jsx(xe,{})})}),w.jsx(c,{path:"/senders",element:w.jsx(de,{children:w.jsx(pe,{})})}),w.jsx(c,{path:"/send",element:w.jsx(de,{children:w.jsx(ue,{})})}),w.jsx(c,{path:"/campaigns",element:w.jsx(de,{children:w.jsx(ge,{})})}),w.jsx(c,{path:"/campaigns/:id",element:w.jsx(de,{children:w.jsx(ye,{})})}),w.jsx(c,{path:"/admin/plans",element:w.jsx(de,{children:w.jsx(Ne,{})})}),w.jsx(c,{path:"/admin/companies",element:w.jsx(de,{children:w.jsx(ze,{})})}),w.jsx(c,{path:"/admin/companies/:id/stats",element:w.jsx(de,{children:w.jsx(Ie,{})})}),w.jsx(c,{path:"/admin/companies/:id/users",element:w.jsx(de,{children:w.jsx($e,{})})}),w.jsx(c,{path:"*",element:w.jsx(l,{to:"/",replace:!0})})]})]})})}k.createRoot(document.getElementById("root")).render(w.jsx(o.StrictMode,{children:w.jsx(Pe,{})}));
